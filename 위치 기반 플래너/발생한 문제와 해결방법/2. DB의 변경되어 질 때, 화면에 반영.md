---
sticker: emoji//1f62a
tags: 문제
---
# DB의 변경되어 질 때, 화면에 반영

### 문제 상황

- `DB`의 데이터가 추가, 삭제, 업데이트**와 같이 **변경**이 발생할 때, 데이터 목록이 새롭게 **화면에 반영**되어야 한다.

### 해결 방법

- `ViewModel`을 통한 데이터 공유
    - `Activity`와 `Fragment` 간 데이터를 공유한다.
    - `MutableStateFlow`를 통해 **DB의 쿼리 과정**에서의 **상태 변화 값을 구독하는 대상에게 전달**한다.
        - DB의 쿼리 과정에서의 상태는 **`Loading, Error, data`** 3개가 있다.
            - `Loading` : 로딩 상태임을 **구독자에게 전달**하기 위한 (`Boolean` 값)
            - `Error` : 에러가 발생했을 때, 구독자에게 에러가 발생했음을 전달
            - `data` : 성공적으로 쿼리가 마쳤을 때, `data`의 결과가 저장
            
- **데이터 변화 체크**
    - 데이터 변화를 체크하여, **db**의 데이터가 **새롭게 업데이트** 되면, `recyclerview`의 **`notifyDataSetChanged()`** 를 통해 화면을 새롭게 업데이트 한다.

### 배운점
* `ViewModel`을 이용하여 데이터를 공유하고, 데이터의 변화 감지를 `MutableStateFlow`를 통해 감지하여, 각 상태마다 `UI`를 업데이트 할 수 있게 되었다.
